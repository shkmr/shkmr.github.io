<html>
<body>
<a href="../scmxref/index.html">index</a>
<pre>
(<a href="http://practical-scheme.net/gauche/man/?l=en&p=define-module">define-module</a> <a href="path-util.scm.html#path-util.scm:1">scmxref.path-util</a>
<a name="path-util.scm:2"></a>  (<a href="http://practical-scheme.net/gauche/man/?l=en&p=use">use</a> <a href="http://practical-scheme.net/gauche/man/?l=en&p=file.util">file.util</a>)
<a name="path-util.scm:3"></a>  (<a href="http://practical-scheme.net/gauche/man/?l=en&p=use">use</a> <a href="http://practical-scheme.net/gauche/man/?l=en&p=srfi-11">srfi-11</a>) ; let-values
<a name="path-util.scm:4"></a>  (<a href="http://practical-scheme.net/gauche/man/?l=en&p=export">export</a> <a href="path-util.scm.html#path-util.scm:22">canonical-path</a>
<a name="path-util.scm:5"></a>          <a href="path-util.scm.html#path-util.scm:80">relative-path</a>
<a name="path-util.scm:6"></a>          <a href="path-util.scm.html#path-util.scm:45">path-to-top</a>
<a name="path-util.scm:7"></a>          ))
<a name="path-util.scm:8"></a>(<a href="http://practical-scheme.net/gauche/man/?l=en&p=select-module">select-module</a> <a href="path-util.scm.html#path-util.scm:1">scmxref.path-util</a>)
<a name="path-util.scm:9"></a>;;
<a name="path-util.scm:10"></a>;; ---  not really belongs to scmxref
<a name="path-util.scm:11"></a>;;
<a name="path-util.scm:12"></a>
<a name="path-util.scm:13"></a>;;;
<a name="path-util.scm:14"></a>;;;  Pathname utilities: canonical-path, relative-path, path-to-top.
<a name="path-util.scm:15"></a>;;;
<a name="path-util.scm:16"></a>
<a name="path-util.scm:17"></a>;;
<a name="path-util.scm:18"></a>;;  Function: &lt;code&gt;canonical-path path&lt;/code&gt;
<a name="path-util.scm:19"></a>;;
<a name="path-util.scm:20"></a>;;    Calculate canonical path of &lt;code&gt;path&lt;/code&gt;.
<a name="path-util.scm:21"></a>;;
<a name="path-util.scm:22"></a>(<a href="http://practical-scheme.net/gauche/man/?l=en&p=define">define</a> (<a href="path-util.scm.html#path-util.scm:22">canonical-path</a> path)
<a name="path-util.scm:23"></a>  (<a href="http://practical-scheme.net/gauche/man/?l=en&p=simplify-path">simplify-path</a>
<a name="path-util.scm:24"></a>   (<a href="http://practical-scheme.net/gauche/man/?l=en&p=sys-normalize-pathname">sys-normalize-pathname</a>
<a name="path-util.scm:25"></a>    path :absolute #t :canonicalize #t)))
<a name="path-util.scm:26"></a>
<a name="path-util.scm:27"></a>;;
<a name="path-util.scm:28"></a>;; Function: &lt;code&gt;path-to-top path&lt;/code&gt;
<a name="path-util.scm:29"></a>;;
<a name="path-util.scm:30"></a>;;   Calculate path to top directory from dirname of &lt;code&gt;path&lt;/code&gt;.
<a name="path-util.scm:31"></a>;;   An error is raised if &lt;code&gt;path&lt;/code&gt; goes beyond top.
<a name="path-util.scm:32"></a>;;
<a name="path-util.scm:33"></a>;;   Example:
<a name="path-util.scm:34"></a>;;
<a name="path-util.scm:35"></a>;;     (path-to-top "")            =&gt; ""
<a name="path-util.scm:36"></a>;;     (path-to-top "foo")         =&gt; ""
<a name="path-util.scm:37"></a>;;     (path-to-top "foo/")        =&gt; "../"
<a name="path-util.scm:38"></a>;;     (path-to-top "foo/bar")     =&gt; "../"
<a name="path-util.scm:39"></a>;;     (path-to-top "foo/bar/")    =&gt; "../../"
<a name="path-util.scm:40"></a>;;     (path-to-top "foo/../bar")  =&gt; ""
<a name="path-util.scm:41"></a>;;     (path-to-top "foo/../bar/") =&gt; "../"
<a name="path-util.scm:42"></a>;;     (path-to-top "foo/../../")  =&gt; ERROR
<a name="path-util.scm:43"></a>;;     (path-to-top "../")         =&gt; ERROR
<a name="path-util.scm:44"></a>;;
<a name="path-util.scm:45"></a>(<a href="http://practical-scheme.net/gauche/man/?l=en&p=define">define</a> (<a href="path-util.scm.html#path-util.scm:45">path-to-top</a> pathname)
<a name="path-util.scm:46"></a>  (<a href="http://practical-scheme.net/gauche/man/?l=en&p=let">let</a> ((path (<a href="http://practical-scheme.net/gauche/man/?l=en&p=simplify-path">simplify-path</a>
<a name="path-util.scm:47"></a>               (<a href="http://practical-scheme.net/gauche/man/?l=en&p=if">if</a> (<a href="http://practical-scheme.net/gauche/man/?l=en&p=absolute-path?">absolute-path?</a> pathname)
<a name="path-util.scm:48"></a>                 (<a href="http://practical-scheme.net/gauche/man/?l=en&p=string-copy">string-copy</a> pathname 1 (<a href="http://practical-scheme.net/gauche/man/?l=en&p=string-length">string-length</a> pathname))
<a name="path-util.scm:49"></a>                 pathname))))
<a name="path-util.scm:50"></a>    (<a href="http://practical-scheme.net/gauche/man/?l=en&p=let">let</a> lp ((path path)
<a name="path-util.scm:51"></a>             (lis  '()))
<a name="path-util.scm:52"></a>      (<a href="http://practical-scheme.net/gauche/man/?l=en&p=if">if</a> (<a href="http://practical-scheme.net/gauche/man/?l=en&p=eq?">eq?</a> (<a href="http://practical-scheme.net/gauche/man/?l=en&p=string-scan">string-scan</a> path "../") 0)
<a name="path-util.scm:53"></a>        (<a href="http://practical-scheme.net/gauche/man/?l=en&p=error">error</a> "Invalid path " pathname)
<a name="path-util.scm:54"></a>        (<a href="http://practical-scheme.net/gauche/man/?l=en&p=cond">cond</a> ((<a href="http://practical-scheme.net/gauche/man/?l=en&p=string=?">string=?</a> path "/")
<a name="path-util.scm:55"></a>               (<a href="http://practical-scheme.net/gauche/man/?l=en&p=apply">apply</a> <a href="http://practical-scheme.net/gauche/man/?l=en&p=string-append">string-append</a> lis))
<a name="path-util.scm:56"></a>              ((<a href="http://practical-scheme.net/gauche/man/?l=en&p=string-scan">string-scan</a> path #\/ 'after)
<a name="path-util.scm:57"></a>               <a href="http://practical-scheme.net/gauche/man/?l=en&p==>">=></a> (<a href="http://practical-scheme.net/gauche/man/?l=en&p=lambda">lambda</a> (path)
<a name="path-util.scm:58"></a>                    (lp path (<a href="http://practical-scheme.net/gauche/man/?l=en&p=cons">cons</a> "../" lis))))
<a name="path-util.scm:59"></a>              (<a href="http://practical-scheme.net/gauche/man/?l=en&p=else">else</a>
<a name="path-util.scm:60"></a>               (<a href="http://practical-scheme.net/gauche/man/?l=en&p=apply">apply</a> <a href="http://practical-scheme.net/gauche/man/?l=en&p=string-append">string-append</a> lis)))))))
<a name="path-util.scm:61"></a>
<a name="path-util.scm:62"></a>;;
<a name="path-util.scm:63"></a>;; Function: &lt;code&gt;relative-path from to&lt;/code&gt;
<a name="path-util.scm:64"></a>;;
<a name="path-util.scm:65"></a>;;   Calculate relative path from &lt;code&gt;from&lt;/code&gt; to &lt;code&gt;to&lt;/code&gt;.
<a name="path-util.scm:66"></a>;;
<a name="path-util.scm:67"></a>;;   Example: in case (current-directory) =&gt; "/home/smith"
<a name="path-util.scm:68"></a>;;
<a name="path-util.scm:69"></a>;;     (relative-path "" "")                =&gt; ""
<a name="path-util.scm:70"></a>;;     (relative-path "foo" "")             =&gt; ""
<a name="path-util.scm:71"></a>;;     (relative-path "foo/" "")            =&gt; "../"
<a name="path-util.scm:72"></a>;;     (relative-path "foo/" "foo/bar")     =&gt; "bar"
<a name="path-util.scm:73"></a>;;     (relative-path "foo/" "foo/bar/")    =&gt; "bar/"
<a name="path-util.scm:74"></a>;;     (relative-path "../foo/" "foo/bar/") =&gt; "../smith/foo/bar/"
<a name="path-util.scm:75"></a>;;     (relative-path "" "../..")           =&gt; "../../"
<a name="path-util.scm:76"></a>;;     (relative-path "" "../../..")        =&gt; "../../"  ; parent of root is itself.
<a name="path-util.scm:77"></a>;;
<a name="path-util.scm:78"></a>;;   BUG: the last case does not work as expected.
<a name="path-util.scm:79"></a>;;
<a name="path-util.scm:80"></a>(<a href="http://practical-scheme.net/gauche/man/?l=en&p=define">define</a> (<a href="path-util.scm.html#path-util.scm:80">relative-path</a> from to)
<a name="path-util.scm:81"></a>  (<a href="http://practical-scheme.net/gauche/man/?l=en&p=let">let</a> lp ((f0 (<a href="path-util.scm.html#path-util.scm:22">canonical-path</a> from))
<a name="path-util.scm:82"></a>           (t0 (<a href="path-util.scm.html#path-util.scm:22">canonical-path</a> to)))
<a name="path-util.scm:83"></a>    (<a href="http://practical-scheme.net/gauche/man/?l=en&p=let-values">let-values</a> (((f1 f2) (<a href="http://practical-scheme.net/gauche/man/?l=en&p=string-scan">string-scan</a> f0 #\/ 'both))
<a name="path-util.scm:84"></a>                 ((t1 t2) (<a href="http://practical-scheme.net/gauche/man/?l=en&p=string-scan">string-scan</a> t0 #\/ 'both)))
<a name="path-util.scm:85"></a>      (<a href="http://practical-scheme.net/gauche/man/?l=en&p=cond">cond</a> ((<a href="http://practical-scheme.net/gauche/man/?l=en&p=and">and</a> f1 t1 (<a href="http://practical-scheme.net/gauche/man/?l=en&p=string=?">string=?</a> f1 t1))
<a name="path-util.scm:86"></a>             (lp f2 t2))
<a name="path-util.scm:87"></a>            (<a href="http://practical-scheme.net/gauche/man/?l=en&p=else">else</a>
<a name="path-util.scm:88"></a>             (<a href="http://practical-scheme.net/gauche/man/?l=en&p=string-append">string-append</a> (<a href="path-util.scm.html#path-util.scm:45">path-to-top</a> f0) t0))))))
<a name="path-util.scm:89"></a>
<a name="path-util.scm:90"></a>(<a href="http://practical-scheme.net/gauche/man/?l=en&p=provide">provide</a> "scmxref/path-util")
<a name="path-util.scm:91"></a>
</pre>
<a href="../scmxref/index.html">index</a>
</body>
</html>
